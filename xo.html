<!doctype html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Ù„Ø¹Ø¨Ø© Ø¥ÙƒØ³-Ø£Ùˆ â€” Ø¨Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #f7f4ef;
      --board-bg: #e6d9c6;
      --square-bg: #fffaf3;
      --sq-size: clamp(68px, 20vw, 110px);
      --gap: clamp(8px, 2.5vw, 16px);
      --xo-dark: #8A2BE2;
      --accent: #8A2BE2;
    }

    html,
    body,
    #app {
      height: 100%
    }

    body {
      font-family: 'Cairo', system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
      background: linear-gradient(180deg, #fffefc 0%, #f4f1ea 60%);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .board-wrapper {
      background: linear-gradient(180deg, rgba(236, 219, 185, 1) 0%, rgba(224, 194, 139, 1) 100%);
      border-radius: 18px;
      padding: clamp(12px, 2.5vw, 20px);
      box-shadow: 0 10px 30px rgba(11, 17, 32, 0.12), inset 0 2px 0 rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(11, 17, 32, 0.06);
    }

    .board {
      display: grid;
      grid-template-columns: repeat(3, var(--sq-size));
      grid-template-rows: repeat(3, var(--sq-size));
      gap: var(--gap);
      justify-content: center;
      align-items: center;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.02), rgba(255, 255, 255, 0.02));
      padding: calc(var(--gap));
      border-radius: 12px;
    }

    .square {
      width: var(--sq-size);
      height: var(--sq-size);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      background: linear-gradient(180deg, var(--square-bg), #f7f3ea);
      box-shadow:
        0 6px 12px rgba(11, 17, 32, 0.12),
        inset 0 6px 10px rgba(0, 0, 0, 0.04),
        inset 0 -6px 8px rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(11, 17, 32, 0.06);
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      transition: transform .12s ease, box-shadow .12s ease;
      border: 1px solid #9400D3;
      box-shadow: 0 0 4px #8A2BE2 ;
    }

    .square:active,
    .square.pressed {
      transform: translateY(4px) scale(0.99);
      box-shadow:
        0 3px 6px rgba(11, 17, 32, 0.14),
        inset 0 3px 8px rgba(0, 0, 0, 0.06);
    }

    .xo {
      width: 72%;
      height: 72%;
      display: block;
    }

    .x-line {
      stroke: var(--xo-dark);
      stroke-width: 10;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .o-ring {
      stroke: var(--xo-dark);
      stroke-width: 10;
      stroke-linecap: round;
      fill: none;
    }

    .placed {
      animation: pop .12s ease;
    }

    @keyframes pop {
      from {
        transform: scale(.88);
        opacity: .0;
      }

      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    .winning {
      box-shadow: 0 0 18px rgba(217, 119, 6, 0.45), inset 0 6px 20px rgba(255, 255, 255, 0.35);
      transform: translateY(-2px) scale(1.02);
    }

    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      margin-top: 12px;
    }

    .btn {
      padding: 8px 12px;
      border-radius: 10px;
      font-weight: 600;
      background: white;
      border: 1px solid rgba(11, 17, 32, 0.06);
      box-shadow: 0 6px 12px rgba(11, 17, 32, 0.06);
    }

    .btn.primary {
      background: linear-gradient(180deg, var(--accent), #b4099d);
      color: white;
      border: none;
      box-shadow: 0 8px 18px rgba(180, 83, 9, 0.22);
    }

    .history {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 10px;
      max-height: 220px;
      overflow: auto;
      padding-right: 6px;
    }

    .history button {
      text-align: right;
      padding: 6px 8px;
      border-radius: 8px;
      color: var(--accent);
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(11, 17, 32, 0.04);
    }

    .title {
      text-align: center;
      margin-bottom: 12px;
      font-weight: 800;
      font-size: 1.28rem;
    }

    main {
      height: calc(100%-40px);
    }

    footer {
      position: fixed;
      width: 100%;
      height: 60px;
      bottom: 0;
      text-align: center;
      padding-top: 12px;
      background: linear-gradient(180deg, var(--accent), #b4099d);
      color: white;
      border: none;
    }
/* Define the keyframes for the color animation */
@keyframes color-change {
  0% {
    color: #007bff; /* Start with a vibrant blue */
  }
  50% {
    color: #6a0572; /* Transition to a rich violet at 50% of the animation */
  }
  100% {
    color: #007bff; /* Return to the starting blue at 100% */
  }
}

/* Apply the animation to the footer link */
footer a {
  font-size: 1.5em;
  font-weight: bold;
  text-decoration: none;

  /* Apply the animation */
  animation: color-change 4s infinite alternate;
}



    @media (max-width:420px) {
      :root {
        --sq-size: clamp(64px, 26vw, 96px);
        --gap: 10px;
      }

      .title {
        font-size: 1.15rem;
      }
    }

    @media (prefers-color-scheme: dark) {
      body {
        background: linear-gradient(180deg, #0b1220 0%, #07101a 60%);
        color: #e6eef7;
      }

      .board-wrapper {
        background: linear-gradient(180deg, #111827, #0b1220);
        box-shadow: 0 8px 28px rgba(0, 0, 0, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.04);
      }

      .square {
        background: linear-gradient(180deg, #0f1724, #0b1220);
        box-shadow: 0 8px 22px rgba(2, 6, 23, 0.6), inset 0 4px 12px rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.02);
      }

      .btn {
        background: #0b1220;
        color: #e6eef7;
        border: 1px solid rgba(255, 255, 255, 0.03);
      }

      .btn.primary {
        background: linear-gradient(180deg, #b45309, #92400e);
      }

      .square .xo {
        filter: drop-shadow(0 2px 0 rgba(0, 0, 0, 0.45));
      }
    }
  </style>
</head>

<body>
  <main class="w-full max-w-md">
    <h1 class="title">Ù„Ø¹Ø¨Ø© Ø¥ÙƒØ³ Ø£Ùˆ âŒ-â­• [ Ù…Ø¹ ÙØ±Ø¯Ùƒ Ø£Ùˆ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ]</h1>

    <div class="board-wrapper">
      <div id="board" class="board" aria-label="Ù„ÙˆØ­Ø© Ù„Ø¹Ø¨Ø© Ø¥ÙƒØ³ Ø£Ùˆ"></div>

      <div class="controls mt-4">
        <div id="status" class="text-sm font-semibold">ÙŠØ§ Ø²ÙˆÙ„ØŒ Ø®Ù„Ù‘Ù†Ø§ Ù†Ø¨Ø¯Ø£</div>
        <button id="restartBtn" class="btn ml-auto" aria-label="Ø¥Ø¹Ø§Ø¯Ø©">Ø£Ù„Ø¹Ø¨ ØªØ§Ù†ÙŠ â†º</button>
        <button id="aiBtn" class="btn primary" aria-pressed="true">Ø£ÙˆÙ‚Ù Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</button>
        <button id="soundBtn" class="btn" aria-pressed="true">ØµÙˆØª: Ø´ØºÙ‘Ø§Ù„</button>
      </div>

      <div class="history-section mt-3">
        <h4 class="text-sm font-semibold mt-3">Ø³Ø¬Ù„ Ø§Ù„Ø­Ø±ÙƒØ§Øª</h4>
        <div id="historyList" class="history"></div>
      </div>
    </div>

  </main>

  <footer>Ù‡ÙˆÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø¯Ø§ Ø­Ù‚ <a href="https://mohammedfade.github.io/Mohammed-Fadi/">ÙØ§Ø¯ÙŠ</a> Ø§ÙˆØ¹Ùƒ ØªØ¬Ø§Ø²ÙÙˆ
  ğŸ§‘â€ğŸ’»</footer>

  <script>
    let history = [Array(9).fill('')];
    let step = 0;
    let xIsNext = true;
    let winnerInfo = { winner: '', line: null };
    let playAgainstAI = true;
    let soundsEnabled = true;
    let audioCtx = null;
    let ttsVoice = null;

    const funnyNextX = [
      "ÙŠØ§ Ø²ÙˆÙ„ØŒ Ø¯ÙˆØ±Ùƒ ÙŠØ§ X â€” ÙˆØ±Ù‘ÙŠÙ†Ø§ Ù„Ø¹Ø¨Ùƒ! ğŸ˜",
      "Ø´ØºÙ„ Ø¨Ø®Ø®Ø®Ø®Ø®Ø®Ø®Ø®ØªÙ„Ù ÙŠØ§ Ø³Ø¹Ø§Ø¯ØªÙƒğŸ«¡",
       "Ø¯Ù†ÙŠØ§ Ø²Ø§Ø§Ø§Ø§ÙŠÙ„ÙŠ ÙˆÙ†Ø¹ÙŠÙ…ÙƒÙŠ Ø²Ø§Ø§ÙŠÙ„ ğŸ˜¶â€ğŸŒ«ï¸"
    ];

    const funnyNextO = [
      "Ø§Ø³ÙŠ Ø¯Ø§ Ù„Ø¹Ø¨ Ù„ÙŠÙŠÙƒ Ù…Ø¹ Ø§Ù„Ù†Ø§Ø³ ğŸ™„",
      "Ø§Ø²Ù†Ù‚ Ø§Ù… ÙƒØ¹ÙˆÙˆÙˆÙƒ Ù„Ù…Ù† ÙŠØ¬ÙŠØ¨ Ø§Ù„Ø²ÙŠØªğŸ¤£",
      "ÙŠØ§ Ø£ÙˆØ¨Ø§ OØŒ Ø®Ø´ Ø§Ù„Ø­ÙŠØ·Ø© ÙˆØ§Ø¯Ø®Ù„Ù‡Ø§!"
    ];

    const funnyWinner = [
      "Ø£Ù‡Ø§! Ø§Ù„ÙØ§ÙŠØ²: {w} â€” Ø§Ù„Ø¨Ø±ÙƒØ© ÙÙŠÙ‡Ùˆ! ğŸ‰",
      "Ø´Ø±Ø±Ø±Ùƒ Ù„ÙŠ Ø´Ø±Ø±Ø±Ùƒ Ù„ÙŠ Ø´Ø±Ø±Ø±Ùƒ Ù„ÙŠ ğŸ¤£",
      "{w} Ù†Ø¬Ù… Ø§Ù„Ù…Ø§ØªØ´ â€” Ø´ÙˆÙÙˆØ§ Ø§Ù„Ø¯Ø§ÙŠØ±Ø©! âœ¨"
    ];

    const funnyDraw = [
      "Ù…Ø§ Ø¹Ù†Ø¯Ù†Ø§ ØªØ¹Ø§Ø¯Ù„ ØªÙ„Ø¹Ø¨Ùˆ Ù„Ù…Ù…Ù† ÙˆØ§Ø­Ø¯ ÙŠØªØ¨Ù„Ø© ğŸ˜",
      "Ù…Ø§Ø´ÙŠ Ø§Ù„Ø­Ø§Ù„ØŒ ØªØ¹Ø§Ø¯Ù„ Ø­Ù„Ùˆ! Ù†Ø¹ÙŠØ¯Ù‡Ø§ØŸ",
      "Ù†Øµ ÙˆÙ†Øµ â€” Ù„Ø¹Ø¨ØªÙˆØ§ ÙƒÙˆÙŠØ³ÙŠÙ†!"
    ];

    const boardEl = document.getElementById('board');
    const statusEl = document.getElementById('status');
    const historyListEl = document.getElementById('historyList');
    const restartBtn = document.getElementById('restartBtn');
    const aiBtn = document.getElementById('aiBtn');
    const soundBtn = document.getElementById('soundBtn');

    function ensureAudio() {
      if (audioCtx) return;
      try {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      } catch (e) {
        audioCtx = null;
      }
    }

    /* percussive click using filtered noise */
    function playMoveSound() {
      if (!soundsEnabled) return;
      ensureAudio();
      if (!audioCtx) return;

      const now = audioCtx.currentTime;
      // noise buffer
      const bufferSize = audioCtx.sampleRate * 0.13; // 30ms
      const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
      const data = buffer.getChannelData(0);
      for (let i = 0; i < bufferSize; i++) data[i] = (Math.random() * 2 - 1) * Math.exp(-i / (bufferSize / 8));
      const noise = audioCtx.createBufferSource();
      noise.buffer = buffer;

      // filter to give warm thud
      const band = audioCtx.createBiquadFilter();
      band.type = 'bandpass';
      band.frequency.value = 800;
      band.Q.value = 0.8;

      const gain = audioCtx.createGain();
      gain.gain.setValueAtTime(0.0001, now);
      gain.gain.exponentialRampToValueAtTime(0.25, now + 0.005);
      gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.06);

      noise.connect(band);
      band.connect(gain);
      gain.connect(audioCtx.destination);

      noise.start(now);
      noise.stop(now + 0.06);
    }

    /* short celebratory melody */
    function playWinSound() {
      if (!soundsEnabled) return;
      ensureAudio();
      if (!audioCtx) return;

      const now = audioCtx.currentTime;
      // small reverb using delay+feedback
      const delay = audioCtx.createDelay();
      delay.delayTime.value = 0.06;
      const fb = audioCtx.createGain();
      fb.gain.value = 0.35;
      delay.connect(fb);
      fb.connect(delay);

      const master = audioCtx.createGain();
      master.gain.value = 0.9;
      delay.connect(master);
      master.connect(audioCtx.destination);

      const seq = [880, 660, 990]; // frequencies (A5-ish, E5-ish, B5-ish) â€” joyful
      seq.forEach((freq, i) => {
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.type = 'sine';
        osc.frequency.value = freq;
        g.gain.setValueAtTime(0.0001, now + i * 0.12);
        g.gain.exponentialRampToValueAtTime(0.28, now + i * 0.12 + 0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, now + i * 0.12 + 0.18);
        osc.connect(g);
        g.connect(delay);
        osc.start(now + i * 0.12);
        osc.stop(now + i * 0.12 + 0.22);
      });

      // short sub-bass thump
      const bass = audioCtx.createOscillator();
      const bg = audioCtx.createGain();
      bass.type = 'triangle';
      bass.frequency.value = 110;
      bg.gain.setValueAtTime(0.0001, now);
      bg.gain.exponentialRampToValueAtTime(0.18, now + 0.01);
      bg.gain.exponentialRampToValueAtTime(0.0001, now + 0.18);
      bass.connect(bg);
      bg.connect(audioCtx.destination);
      bass.start(now);
      bass.stop(now + 0.2);
    }

    /* speak a Sudanese phrase using SpeechSynthesis (if available) */
    function speakSudanese(text) {
      if (!soundsEnabled) return;
      if (!('speechSynthesis' in window)) return;
      // choose Arabic voice if available
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = 'ar';
      // try to pick an Arabic voice (may vary per device)
      const voices = window.speechSynthesis.getVoices();
      if (voices && voices.length) {
        const ar = voices.find(v => v.lang && v.lang.startsWith('ar'));
        if (ar) utter.voice = ar;
      }
      // short and lively
      utter.rate = 1.05;
      utter.pitch = 1.05;
      window.speechSynthesis.cancel(); // stop previous
      window.speechSynthesis.speak(utter);
    }

    /* ---- SVG helpers (X/O) ---- */
    function svgX() {
      return `
    <svg class="xo placed" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <line class="x-line" x1="20" y1="20" x2="80" y2="80"></line>
      <line class="x-line" x1="80" y1="20" x2="20" y2="80"></line>
    </svg>`;
    }
    function svgO() {
      return `
    <svg class="xo placed" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <circle class="o-ring" cx="50" cy="50" r="30"></circle>
    </svg>`;
    }

    function createBoardButtons() {
      boardEl.innerHTML = '';
      for (let i = 0; i < 9; i++) {
        const btn = document.createElement('button');
        btn.className = 'square';
        btn.setAttribute('data-i', i);
        btn.setAttribute('aria-label', `Ù…Ø±Ø¨Ø¹ ${i + 1}`);
        btn.addEventListener('click', () => handleClick(i));
        btn.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); handleClick(i); } });
        boardEl.appendChild(btn);
      }
    }

    function calculateWinner(sq) {
      const lines = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
      for (const [a, b, c] of lines) {
        if (sq[a] && sq[a] === sq[b] && sq[a] === sq[c]) {
          return { winner: sq[a], line: [a, b, c] };
        }
      }
      return { winner: '', line: null };
    }

    function render() {
      const current = history[step];
      const buttons = boardEl.querySelectorAll('.square');
      buttons.forEach((btn, i) => {
        btn.classList.remove('winning', 'pressed');
        btn.innerHTML = '';
        if (current[i]) {
          btn.innerHTML = current[i] === 'X' ? svgX() : svgO();
        }
      });

      if (winnerInfo.line) {
        winnerInfo.line.forEach(idx => {
          const el = boardEl.querySelector(`button[data-i="${idx}"]`);
          if (el) el.classList.add('winning');
        });
      }

      let status = '';
      if (winnerInfo.winner) {
        const raw = funnyWinner[step % funnyWinner.length];
        const wName = winnerInfo.winner === 'X' ? 'Ø¥ÙƒØ³ (X)' : 'Ø£Ùˆ (O)';
        status = raw.replace('{w}', wName);
      } else if (current.every(Boolean)) {
        status = funnyDraw[step % funnyDraw.length];
      } else {
        status = xIsNext ? funnyNextX[step % funnyNextX.length] : funnyNextO[step % funnyNextO.length];
      }
      statusEl.textContent = status;

      historyListEl.innerHTML = '';
      history.forEach((_, move) => {
        const li = document.createElement('div');
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.style.width = '100%';
        btn.style.textAlign = 'right';
        btn.textContent = move ? `ÙŠØ§ Ø¹Ù…Ùˆ Ø¹Ø¨Ø¯ Ø§Ø±Ø¬Ø¹ Ù„ÙŠ ÙˆØ±Ø§ ${move} ÙˆØ§Ø¨Ø±ÙˆÙ…Ø§ ğŸ˜‚` : 'ÙˆØ§Ø§ÙŠ ÙˆØ§Ø§ÙŠ ÙˆØ§Ø§ÙŠ ÙˆØ§Ø§Ø§Ø§Ø§Ø§Ø§Ø§ÙŠÙŠ ğŸ¤£ Ø§Ø¨Ø¯Ø§Ù‡Ø§ Ù„ÙŠ Ù…Ù† Ø§Ù„Ø£ÙˆÙ„';
        btn.addEventListener('click', () => jumpTo(move));
        li.appendChild(btn);
        historyListEl.appendChild(li);
      });
    }

    function handleClick(i) {
      const current = history[step];
      if (winnerInfo.winner || current[i]) return;

      // ensure audio context created on first gesture
      ensureAudio();

      const newSquares = current.slice();
      newSquares[i] = xIsNext ? 'X' : 'O';
      history = history.slice(0, step + 1).concat([newSquares]);
      step = history.length - 1;
      xIsNext = !xIsNext;
      winnerInfo = calculateWinner(history[step]);

      // play move sound and optional short TTS "ÙŠØ§ Ø²ÙˆÙ„" whisper (kept short)
      playMoveSound();

      render();

      // if someone won, play win sound + TTS
      if (winnerInfo.winner) {
        // short delay so visuals update first
        setTimeout(() => {
          playWinSound();
          const raw = funnyWinner[step % funnyWinner.length];
          const wName = winnerInfo.winner === 'X' ? 'Ø¥ÙƒØ³' : 'Ø£Ùˆ';
          const phrase = raw.replace('{w}', wName);
          // speak shorter, more natural phrase in Sudanese style
          speakSudanese(phrase);
        }, 120);
      }

      // AI move if enabled
      if (playAgainstAI && !winnerInfo.winner && !xIsNext) {
        setTimeout(() => aiMove(), 1500);
      }
    }

    function jumpTo(move) {
      step = move;
      xIsNext = (step % 2 === 0);
      winnerInfo = calculateWinner(history[step]);
      render();
    }

    function restart() {
      history = [Array(9).fill('')];
      step = 0;
      xIsNext = true;
      winnerInfo = { winner: '', line: null };
      render();
    }

    function aiMove() {
      const current = history[step].slice();
      const empty = current.map((v, i) => v ? null : i).filter(v => v !== null);

      function findWinning(sym) {
        for (const idx of empty) {
          const tmp = current.slice();
          tmp[idx] = sym;
          const calc = calculateWinner(tmp);
          if (calc.winner === sym) return idx;
        }
        return null;
      }

      let move = findWinning('O');
      if (move === null) move = findWinning('X');
      if (move === null && current[4] === '') move = 4;
      const corners = [0, 2, 6, 8].filter(i => current[i] === '');
      if (move === null && corners.length) move = corners[Math.floor(Math.random() * corners.length)];
      if (move === null && empty.length) move = empty[Math.floor(Math.random() * empty.length)];

      if (move !== null) handleClick(move);
    }

    /* init */
    createBoardButtons();
    render();

    /* events */
    restartBtn.addEventListener('click', restart);
    aiBtn.addEventListener('click', () => {
      playAgainstAI = !playAgainstAI;
      aiBtn.textContent = playAgainstAI ? 'Ø£ÙˆÙ‚Ù Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±' : 'Ø§Ù„Ø¹Ø¨ Ù…Ø¹ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± (ÙƒÙŠØ´Ø©)';
      aiBtn.setAttribute('aria-pressed', String(playAgainstAI));
      if (playAgainstAI && !xIsNext && !winnerInfo.winner) setTimeout(aiMove, 650);
    });

    soundBtn.addEventListener('click', () => {
      soundsEnabled = !soundsEnabled;
      soundBtn.textContent = soundsEnabled ? 'ØµÙˆØª: Ø´ØºÙ‘Ø§Ù„' : 'ØµÙˆØª: Ù…Ø·ÙÙŠ';
      soundBtn.setAttribute('aria-pressed', String(soundsEnabled));
      // ensure audio context unlocked on user gesture
      if (soundsEnabled) ensureAudio();
    });

    /* keyboard shortcut: Ctrl/Cmd+Z */
    document.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'z') {
        if (step > 0) jumpTo(step - 1);
      }
    });

    if ('speechSynthesis' in window) {
      window.speechSynthesis.getVoices();
    }
  </script>
</body>

</html>